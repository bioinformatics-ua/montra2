{% comment %}
# -*- coding: utf-8 -*-
# Copyright (C) 2014 Universidade de Aveiro, DETI/IEETA, Bioinformatics Group - http://bioinformatics.ua.pt/
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% load i18n %}
{% load extra_tags %}
{% load static %}
<div class="clearfix row">

    <div class="row span2" style="padding-top:20px; padding-left:20px;">

        <div class="fileupload fileupload-new" data-provides="fileupload" >
            <div class="fileupload-new thumbnail" style="width: 200px; height: 150px;">
                {% if qdict.value %}
                    <a target="_blank" href="{{MEDIA_URL}}{{qdict.value}}" >
                        <img src="{{MEDIA_URL}}{{qdict.value}}" />
                    </a>
                {% else %}
                    <img src="{% static 'upload_images/' %}/nopic_db.png" />
                {% endif %}
            </div>
            <div class="fileupload-preview fileupload-exists thumbnail" style="max-width: 200px; max-height: 150px; line-height: 20px;"></div>
            <div>
        <span class="btn btn-file">
          {% if not readonly %}
              <span class="btn btn-primary fileupload-new">Select image</span>
          {% endif %}
            <span class="fileupload-exists">Change</span>
          <input type="file" id="question_{{ question.number }}_image" name="question_{{ question.number }}_image" />
        </span>
                <a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
            </div>
        </div>

    </div>

    <div class="input span5">
        <div class="pull-left" >
            <input type="hidden" class="" size="50" id="question_{{ question.number }}" name="question_{{ question.number }}" value="{{ qdict.value }}" />
            {% if question.extra %}
                <span class="help-block">{{ question.extra }}</span>
            {% endif %}
            {% if qdict.value %}
                <script type="text/javascript">
                    markAnswered('{{ question.number|removedots }}');
                </script>
            {% endif %}
        </div>

    </div>

</div>
{% block styleinclude %}
    <link rel="stylesheet" href="static/css/bootstrap-fileupload.css">
{% endblock %}

{% block scriptextraincludes %}
    <script type="text/javascript" src="static/js/vendor/bootstrap-fileupload.js"></script>
    <script type="text/javascript">
        $('#question_{{ question.number }}_image').change(function() {
            var filename = $(this).val();
            var lastIndex = filename.lastIndexOf("\\");
            if (lastIndex >= 0) {
                filename = filename.substring(lastIndex + 1);
            }
            $('#question_{{ question.number }}').val(filename);
        });
    </script>
{% endblock %}



